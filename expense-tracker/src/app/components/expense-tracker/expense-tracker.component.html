<mat-tab-group #displayTabGroup>
  <!-- Tab-urile pentru fiecare zi -->
  <mat-tab *ngFor="let day of days; let i = index" [label]="day">
    <div class="tab-navigation">
      <button (click)="previousTab(i)">Previous Day</button>
      <button (click)="nextTab(i)">Next Day</button>
    </div>
    <app-day-expense 
      [day]="day" 
      [expenses]="weeklyExpenses[day]" 
      (update)="updateWeeklyExpenses($event)">
    </app-day-expense>
  </mat-tab>

  <!-- Tab-ul Summary -->
  <mat-tab label="Summary">
    <div class="tab-navigation">
      <button (click)="previousTab(days.length)">Previous Day</button>
      <button (click)="nextTab(days.length)">Next Day</button>
    </div>
    
    <!-- Secțiunea de sumar existentă -->
    <div class="summary">
      <h3>Weekly Total: ${{ calculateWeeklyTotal() }}</h3>
      <button (click)="exportToExcel()">Export to Excel Workbook</button>
    </div>
    <div class="day-table">
      <table border="2">
        <thead>
          <tr>
            <th>Day</th>
            <th>Category</th>
            <th>Total Expense</th>
          </tr>
        </thead>
        <tbody>
          <ng-container *ngFor="let day of days">
            <tr>
              <td [attr.rowspan]="weeklyExpenses[day].length + 1" style="font-weight: bold; text-transform: uppercase;">
                {{ day }}
              </td>
            </tr>
            <tr *ngFor="let expense of weeklyExpenses[day]">
              <td>{{ expense.category }}</td>
              <td>{{ expense.amount }}</td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
    <!-- Secțiunea pentru Pie Chart folosind AG Grid -->
    <div class="chart-section">
      <h3>Weekly Expense Summary by Category</h3>
      <!-- Butonul care declanșează generarea graficului -->
      <button (click)="createChart()">Show Pie Chart</button>
      
      <!-- Grid-ul AG Grid cu sumarul per categorie -->
      <ag-grid-angular
        style="width: 100%; height: 200px;"
        class="ag-theme-alpine"
        [rowData]="categorySummary"
        [columnDefs]="columnDefs"
        [defaultColDef]="defaultColDef"
        (gridReady)="onGridReady($event)"
        [enableCharts]="true">
      </ag-grid-angular>
      
      <!-- Containerul unde AG Grid va desena graficul de tip Pie -->
      <div id="myChart" style="width: 100%; height: 400px; margin-top: 10px;"></div>
      
      <!-- Legenda: se afișează fiecare categorie cu un box colorat corespunzător -->
      <div class="legend">
        <h4>Legend</h4>
        <div *ngFor="let item of categoryLegend" class="legend-item">
          <span class="legend-box" [ngStyle]="{'background-color': item.color}"></span>
          {{ item.category }}
        </div>
      </div>
    </div>
    
    <!-- Secțiunea cu tabelul detaliat (poți să o păstrezi sau să o elimini după preferințe) -->
    
  </mat-tab>
</mat-tab-group>
